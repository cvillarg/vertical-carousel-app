<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">

<!--
`<carousel-selector>` description.

Example:

```html
<carousel-selector></carousel-selector>
```

## Styling

The following custom properties and mixins are available for styling:

| Custom property | Description     | Default        |
|:---------------:|:---------------:| :-------------:|
| --your-var      | var description | default value  |
| --carousel-selector | empty mixin | {}             |

@demo demo/index.html
-->
<dom-module id="carousel-selector">
  <style>
  :host{
    display: block;
    font-family: sans-serif;
  }
  paper-card {
    width: 100%;
    overflow: hidden;
  }
  .content {
    /*big enough so there isn't break lines*/
    width: 9000px;
  }
  .content div{
    display: inline-flex;;
    height: 50px;
    width: 50px;
    border-radius: 50%;
    background-color: #ccc;
    margin: 10px;
    cursor: pointer;
  }
  .content div.selected {
    background-color: purple;
    color: white;
  }
  div span{
    margin: auto;
  }
  </style>
  <template>
    <paper-card elevation="2">
      <div class="content">
        <template is="dom-repeat" items=[[indexItems]]>
          <div on-tap="selectItem"><span>[[item]]</span></div>
        </template>
      </div>
    </paper-card>
  </template>
  <script>
  (function() {
    'use strict';
    Polymer({
      is: 'carousel-selector',

      properties: {
        numItems: Number,
        indexItems: {
          type: Array,
          computed: '_generateIndex(numItems)'
        },
        selectedItem: {
          type: Number,
          notify: true,
          observer: '_onItemSelectedChanged'
        }
      },
      listeners: {
          'dom-change': '_onDomChanged'
      },

      _generateIndex: function(numItems) {
        return Array.apply(null, {length: numItems}).map(function(item, index) { return ++index; });
      },

      _onDomChanged: function(){
        this.set('_itemNodes', this.querySelectorAll('.content div'));
        //update the view, refresh the value again..
        this._onItemSelectedChanged(this.selectedItem);
      },

      selectItem: function(e){
        this.set('selectedItem', e.model.item-1);
      },

      _onItemSelectedChanged: function(newValue, oldValue){
        this._itemNodes = this._itemNodes || [];
        //order matters. think of old === newValue
        this.toggleClass('selected', false, this._itemNodes[oldValue]);
        this.toggleClass('selected', true, this._itemNodes[newValue]);

      }
    });
  })();
  </script>
</dom-module>
